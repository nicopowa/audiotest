/**
 * Nico Pr â€” https://nicopr.fr
 * AUDIOTEST PACKAGE RELEASE v0.0.7
 * 08/01/2025 04:10:19
 */
(function(){
function f(){this.l=!1;this.h=null;this.s=void 0;this.g=1;this.o=this.j=0;this.i=null}function g(a){if(a.l)throw new TypeError("Generator is already running");a.l=!0}f.prototype.m=function(a){this.s=a};function h(a,b){a.i={X:b,Z:!0};a.g=a.j||a.o}f.prototype.return=function(a){this.i={return:a};this.g=this.o};function k(a,b,c){a.g=c;return{value:b}}function m(a){a.j=0;var b=a.i.X;a.i=null;return b}function p(a){this.g=new f;this.h=a}
function q(a,b){g(a.g);var c=a.g.h;if(c)return r(a,"return"in c?c["return"]:function(d){return{value:d,done:!0}},b,a.g.return);a.g.return(b);return t(a)}function r(a,b,c,d){try{var e=b.call(a.g.h,c);if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object");if(!e.done)return a.g.l=!1,e;var n=e.value}catch(l){return a.g.h=null,h(a.g,l),t(a)}a.g.h=null;d.call(a.g,n);return t(a)}
function t(a){for(;a.g.g;)try{var b=a.h(a.g);if(b)return a.g.l=!1,{value:b.value,done:!1}}catch(c){a.g.s=void 0,h(a.g,c)}a.g.l=!1;if(a.g.i){b=a.g.i;a.g.i=null;if(b.Z)throw b.X;return{value:b.return,done:!0}}return{value:void 0,done:!0}}
function u(a){this.next=function(b){g(a.g);a.g.h?b=r(a,a.g.h.next,b,a.g.m):(a.g.m(b),b=t(a));return b};this.throw=function(b){g(a.g);a.g.h?b=r(a,a.g.h["throw"],b,a.g.m):(h(a.g,b),b=t(a));return b};this.return=function(b){return q(a,b)};this[Symbol.iterator]=function(){return this}}function v(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function n(l){l.done?d(l.value):Promise.resolve(l.value).then(b,c).then(n,e)}n(a.next())})}
function w(a){return v(new u(new p(a)))}var x=this||self;function y(a){a=a.split(".");var b=x;a[0]in b||"undefined"==typeof b.execScript||b.execScript("var "+a[0]);for(var c;a.length&&(c=a.shift());)a.length?b[c]&&b[c]!==Object.prototype[c]?b=b[c]:b=b[c]={}:b[c]=!1};y("DEBUG");y("STAND");window.addEventListener("load",function(){return new z});
function z(){var a=this;this.S=["1.mp3","2.mp3"];this.J=!0;this.P=this.h=this.g=this.u=this.I=this.j=this.R=this.i=this.T=this.D=this.C=this.v=this.m=this.l=this.K=this.O=this.L=this.W=this.V=this.U=this.F=this.A=this.progress=this.N=this.H=this.B=this.G=this.M=null;this.s=document.getElementById("wrap");this.o=0;this.files=[];var b=document.createElement("div");b.id="liftoff";b.innerHTML="click || touch";this.s.appendChild(b);document.body.addEventListener("click",function(){b.remove();A(a)},{once:!0})}
function A(a){var b;w(function(c){switch(c.g){case 1:return a.h=new (window.AudioContext||window.webkitAudioContext)({}),k(c,B(a),2);case 2:return C(a),D(a),a.i=a.h.createGain(),a.T=a.h.createMediaElementSource(a.g),a.D=a.h.createGain(),a.D.gain.value=.2,a.C=a.h.createOscillator(),a.C.type="sine",a.C.frequency.value=440,a.C.connect(a.D),a.C.start(0),E(a),F(a),c.j=3,k(c,G(a),5);case 5:c.g=4;c.j=0;break;case 3:b=m(c),console.log(b),a.J=!1;case 4:return a.T.connect(a.i),a.J&&a.i.connect(a.u.h),a.i.connect(a.R),
k(c,H(a),6);case 6:a.P=function(){return a.Y.bind(a)()},I(a),c.g=0}})}function B(a){return w(function(b){return k(b,a.h.resume(),0)})}
function C(a){a.g=new Audio;a.g.addEventListener("play",function(){J("playing");K(a)});a.g.addEventListener("pause",function(){J("paused");K(a)});a.g.addEventListener("timeupdate",function(){var b=1E3*(a.g.currentTime||0),c=1E3*Math.round(b/1E3),d=1E3*(a.g.duration||0);a.N.style.width=b/d*100+"%";a.F.textContent=L(c);a.A.textContent=L(d-c);"mediaSession"in navigator&&a.g.duration&&navigator.mediaSession.setPositionState({position:a.g.currentTime,duration:a.g.duration,playbackRate:a.g.playbackRate})});
a.g.addEventListener("ended",function(){M(a,1)});a.g.addEventListener("error",function(b){console.error("Audio Player Error:",b)})}function G(a){return w(function(b){a.u=new N(a.h,a.I);return k(b,O(a.u),0)})}function D(a){a.j=new Audio;a.j.addEventListener("play",function(){return P(a)});a.j.addEventListener("pause",function(){return P(a)});a.j.addEventListener("timeupdate",function(){a.G.textContent=L(1E3*a.j.currentTime)});a.R=a.h.createMediaStreamDestination();a.j.srcObject=a.R.stream}
function H(a){return w(function(b){return k(b,a.j.play(),0)})}function E(a){for(var b=a.h.createBuffer(2,a.h.sampleRate,a.h.sampleRate),c=b.getChannelData(0),d=b.getChannelData(1),e=0;e<a.h.sampleRate;e++)c[e]=0,d[e]=0;a.v=a.h.createBufferSource();a.v.buffer=b;a.v.loop=!0;a.v.start(0)}
function F(a){a.J&&Q(a);a.m=document.createElement("div");a.m.className="player";a.s.appendChild(a.m);R(a);S(a);aa(a);ba(a);ca(a);da(a);ea(a);a.l=document.createElement("div");a.l.className="controls";a.s.appendChild(a.l);a.K=T("beep");a.l.appendChild(a.K);a.K.addEventListener("change",function(){a.K.firstChild.checked?a.D.connect(a.i):a.D.disconnect(a.i)});a.O=T("quiet");a.l.appendChild(a.O);a.O.addEventListener("change",function(){a.O.firstChild.checked?a.v.connect(a.i):a.v.disconnect(a.i)});a.J&&
(a.L=T("bars",!0),a.l.appendChild(a.L),a.L.addEventListener("change",function(){a.L.firstChild.checked?a.i.connect(a.u.h):(a.i.disconnect(a.u.h),a.u.o.fill(0))}));fa(a);ha(a)}function S(a){var b=document.createElement("div");b.className="prev-btn";b.tabIndex=0;b.innerHTML='\n\t\t\t<svg viewBox="0 0 24 24" class="previous-icon">\n\t\t\t\t<path d="M6,3 L6,21 M6,12 L18,3 L18,21 L6,12"/>\n\t\t\t</svg>\n\t\t';b.addEventListener("click",function(){M(a,-1)});a.m.appendChild(b);a.W=b}
function aa(a){var b=U();b.addEventListener("click",function(){return V(a)});a.m.appendChild(b);a.V=b}
function U(){var a=document.createElement("div");a.className="play-btn";a.setAttribute("data-state","paused");a.innerHTML='\n\t\t\t<svg viewBox="0 0 24 24" class="play-icon">\n\t\t\t\t<polygon points="5,3 19,12 5,21"/>\n\t\t\t</svg>\n\t\t\t<svg viewBox="0 0 24 24" class="pause-icon">\n\t\t\t\t<line x1="6" y1="3" x2="6" y2="21"/>\n\t\t\t\t<line x1="18" y1="3" x2="18" y2="21"/>\n\t\t\t</svg>\n\t\t';return a}
function ba(a){var b=document.createElement("div");b.className="next-btn";b.tabIndex=0;b.innerHTML='\n\t\t\t<svg viewBox="0 0 24 24" class="next-icon">\n\t\t\t\t<path d="M18,3 L18,21 M18,12 L6,3 L6,21 L18,12"/>\n\t\t\t</svg>\n\t\t';b.addEventListener("click",function(){M(a,1)});a.m.appendChild(b);a.U=b}function R(a){a.F=document.createElement("div");a.F.className="time-elapsed";a.F.innerHTML="00:00";a.m.appendChild(a.F)}
function ca(a){a.A=document.createElement("div");a.A.className="time-remaining";a.A.innerHTML="00:00";a.m.appendChild(a.A)}function da(a){a.progress=document.createElement("div");a.progress.className="audio-progress";a.s.appendChild(a.progress);a.N=document.createElement("div");a.N.className="progress-bar";a.progress.appendChild(a.N);a.progress.addEventListener("click",function(b){var c=a.progress.getBoundingClientRect();a.g.currentTime=(b.clientX-c.left)/c.width*a.g.duration})}
function ea(a){a.H=document.createElement("div");a.H.className="track-title";a.H.innerText="\u2014";a.s.appendChild(a.H)}function T(a,b){b=void 0===b?!1:b;var c=document.createElement("label");c.classList.add("ezcheck");var d=document.createElement("input");d.type="checkbox";c.appendChild(d);b&&(d.checked=!0);b=document.createElement("span");b.innerHTML=a;c.appendChild(b);return c}function Q(a){a.I=document.createElement("div");a.I.id="audiovis";a.s.appendChild(a.I)}
function fa(a){var b=document.createElement("span");b.classList.add("btn");b.innerHTML="browse";a.l.appendChild(b);var c=document.createElement("input");c.type="file";c.accept=[".mp3",".flac",".wav"];c.multiple=!0;c.style.display="none";b.addEventListener("click",function(){return c.click()});c.addEventListener("change",function(d){d=d.target.files;2>d.length||(a.files&&a.files.forEach(function(e){return URL.revokeObjectURL(e)}),a.files=[URL.createObjectURL(d[0]),URL.createObjectURL(d[1])],a.S=[d[0].name,
d[1].name],a.o=0,I(a))});a.l.appendChild(c)}function ha(a){a.B=document.createElement("div");a.B.className="ctrl-main";a.s.appendChild(a.B);a.M=U();a.B.appendChild(a.M);a.M.addEventListener("click",function(){return ia(a)});a.G=document.createElement("div");a.G.className="time-main";a.G.innerHTML="00:00";a.B.appendChild(a.G)}function K(a){a.V.setAttribute("data-state",a.g.paused?"paused":"playing")}function P(a){a.M.setAttribute("data-state",a.j.paused?"paused":"playing")}
function L(a){return Math.floor(a/6E4).toFixed(0).padStart(2,"0")+":"+Math.floor(a%6E4/1E3).toFixed(0).padStart(2,"0")}function ia(a){var b;return w(function(c){if(1==c.g){c.j=2;if(!a.j.paused){a.j.pause();c.g=4;return}return k(c,H(a),4)}2!=c.g?(c.g=0,c.j=0):(b=m(c),console.error("main play pause failed:",b),c.g=0)})}function V(a){return w(function(b){try{a.g.paused?W(a):a.g.pause()}catch(c){console.error("audio play pause failed:",c)}b.g=0})}
function W(a){w(function(b){return k(b,a.g.play(),0)})}function M(a,b){b=a.o+b;var c=a.S.length-1;a.o=0>b?c:b>c?0:b;I(a)}function X(a){a.focus();setTimeout(function(){return a.blur()},275)}z.prototype.Y=function(){var a=this;Y("play",function(){return V(a)});Y("pause",function(){return V(a)});Y("previoustrack",function(){M(a,-1);X(a.W)});Y("nexttrack",function(){M(a,1);X(a.U)});Y("seekbackward",null);Y("seekforward",null);Y("seekto",function(b){a.g.currentTime=b.seekTime})};
function I(a){a.g.removeEventListener("play",a.P,{once:!0});"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({}));"mediaSession"in navigator&&navigator.mediaSession.setPositionState(null);var b=a.S[a.o];a.H.innerText=b;a.files&&a.files[a.o]?a.g.src=a.files[a.o]:a.g.src="tracks/"+b;b=b.slice(0,b.lastIndexOf("."));a.g.addEventListener("play",a.P,{once:!0});W(a);"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:"track "+b,artist:"artist "+
b,album:"album "+b,artwork:[96,128,192,256,384,512].map(function(c){return{src:"covers/"+(a.o+1)+".png",sizes:c+"x"+c,type:"image/png"}})}))}function J(a){"mediaSession"in navigator&&(navigator.mediaSession.playbackState=a)}function Y(a,b){"mediaSession"in navigator&&navigator.mediaSession.setActionHandler(a,b)}
function N(a,b){var c=this;this.g=document.createElement("canvas");this.g.width=b.clientWidth;this.g.height=b.clientHeight;b.appendChild(this.g);this.j=this.g.getContext("2d",{alpha:!1,desynchronized:!0});this.s=a;this.h=null;this.i=(new Float32Array(24)).fill(0);this.o=(new Float32Array(24)).fill(0);this.v=(b.clientWidth-4*(this.i.length-1))/this.i.length;this.m=null;this.l=0;this.A=getComputedStyle(document.body).getPropertyValue("--text").trim();this.u=getComputedStyle(document.body).getPropertyValue("--back").trim();
window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){c.u=getComputedStyle(document.body).getPropertyValue("--back").trim()})}
function O(a){var b;return w(function(c){if(1==c.g)return c.j=2,k(c,a.s.audioWorklet.addModule("js/audiovis.js"),4);if(2!=c.g)return a.h=new AudioWorkletNode(a.s,"audiovis"),a.h.port.onmessage=function(d){a.o=new Float32Array(d.data)},Z(a,performance.now()),c.return(a.h);b=m(c);console.error("Failed to initialize AudioVis:",b);a.m&&cancelAnimationFrame(a.m);a.h&&a.h.disconnect();a.g&&a.g.parentNode&&a.g.parentNode.removeChild(a.g);throw b;})}
function Z(a,b){a.l||(a.l=b);var c=(b-a.l)/1E3;a.l=b;a.j.clearRect(0,0,a.g.width,a.g.height);a.j.fillStyle=a.u;a.j.fillRect(0,0,a.g.width,a.g.height);a.j.fillStyle=a.A;for(b=0;b<a.i.length;b++){a.i[b]+=(a.o[b]-a.i[b])*Math.min(15*c,1);var d=a.i[b]*a.g.height;a.j.fillRect(b*(a.v+4),a.g.height-d,a.v,d)}a.m=requestAnimationFrame(function(e){return Z(a,e)})};}).call(this);
